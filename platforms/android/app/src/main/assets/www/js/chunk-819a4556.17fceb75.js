(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-819a4556"],{"17e2":function(e,t,s){"use strict";var i=s("2df0"),n=s.n(i);n.a},"20d6":function(e,t,s){"use strict";var i=s("5ca1"),n=s("0a49")(6),o="findIndex",a=!0;o in[]&&Array(1)[o](function(){a=!1}),i(i.P+i.F*a,"Array",{findIndex:function(e){return n(this,e,arguments.length>1?arguments[1]:void 0)}}),s("9c6c")(o)},"255b":function(e,t,s){},"2df0":function(e,t,s){},3598:function(e,t,s){},"38b5":function(e,t,s){e.exports=s.p+"img/男学生.478830f1.png"},"3ff4":function(e,t,s){e.exports=s.p+"img/女学生.d56f6378.png"},4726:function(e,t,s){},"5a5c":function(e,t,s){"use strict";var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"topic_warp"},["FINISH"==e.objective.questionStatus?s("div",{staticClass:"Collection",on:{click:e.Collection}},[s("img",{attrs:{src:e.Collectionsrc,alt:""}})]):e._e(),s("div",{staticClass:"title"},[e._v(e._s(e.objective.title))]),s("div",{staticClass:"topic",domProps:{innerHTML:e._s(e.objective.questionContent)}},[e._v("\n        "+e._s(e.objective.questionContent)+"\n    ")]),e._l(e.objective.options,function(t,i){return 1==e.objective.answer.length?s("div",{key:i,staticClass:"select clearfix",on:{click:function(t){e.selectIndex(i,e.objective.questionId)}}},[s("div",{staticClass:"round"},[e.pointIndex===i?s("span",{staticClass:"point"}):e._e()]),s("div",{staticClass:"option"},[e._v(e._s(e.conversion(i))+".")]),s("div",{staticClass:"text",domProps:{innerHTML:e._s(t)}},[e._v(e._s(t))])]):e._e()}),e._l(e.objective.options,function(t,i){return e.objective.answer.length>1?s("div",{key:i,staticClass:"select clearfix",on:{click:function(t){e.selectsIndex(i,e.objective.questionId)}}},[s("div",{staticClass:"round"},[e.answers.indexOf(i)>-1?s("span",{staticClass:"point"}):e._e()]),s("div",{staticClass:"option"},[e._v(e._s(e.conversion(i))+".")]),s("div",{staticClass:"text",domProps:{innerHTML:e._s(t)}},[e._v(e._s(t))])]):e._e()}),s("PopupPic",{attrs:{questionPic:e.objective.questionPic}}),"FINISH"==e.objective.questionStatus?s("div",{staticClass:"anwers"},[e._v("\n      此题答案为:"),s("span",{domProps:{innerHTML:e._s(e.objective.answer.split("|").join(","))}})]):e._e(),"FINISH"==e.objective.questionStatus?s("div",{staticClass:"remind",domProps:{innerHTML:e._s(e.objective.parse)}}):e._e()],2)},n=[],o=(s("55dd"),s("28a5"),s("5fc6"),s("5af2")),a=s.n(o),r=s("399a"),c=s("a07d"),u={name:"classObjective",components:{PopupPic:c["a"]},props:{objective:{type:Object,default:function(){return{}}}},data:function(){return{pointIndex:-1,answers:"",Collectionsrc:s("f2f6"),Collectiontype:!1}},mounted:function(){this.objective.favor&&(this.Collectiontype=!0,this.Collectionsrc=s("6921"))},methods:{Collection:function(){var e=this;this.Collectiontype?Object(r["k"])(this.objective.questionId).then(function(t){"0010"===t.data.code?(e.Collectiontype=!1,e.Collectionsrc=s("f2f6")):a()({message:t.data.msg,position:"middle",duration:1e3})}):Object(r["a"])(this.objective.questionId).then(function(t){"0010"===t.data.code?(e.Collectiontype=!0,e.Collectionsrc=s("6921")):a()({message:t.data.msg,position:"middle",duration:1e3})})},selectsIndex:function(e,t){var s="";if(this.answers.indexOf(e)>-1){var i=this.answers.split(e);this.answers=i[0]+i[1]}else this.answers=this.answers+e;for(var n=0;n<this.answers.length;n++){var o=parseInt(this.answers[n])+65,a=String.fromCharCode(o);s+=a}s=s.split("").sort().join(""),1==s.length?s+="|":s=s.split("").join("|"),console.log(s),this.$emit("Multipleanswers",t,s)},selectIndex:function(e,t){this.pointIndex=e;var s=65+e,i=String.fromCharCode(s);this.$emit("selectAnswer",t,i)},conversion:function(e){var t=65+e;return String.fromCharCode(t)}}},l=u,d=(s("fba0"),s("2877")),v=Object(d["a"])(l,i,n,!1,null,"45f128b4",null);v.options.__file="classObjective.vue";t["a"]=v.exports},"5e2c":function(e,t,s){"use strict";var i=s("6230"),n=s.n(i);n.a},6230:function(e,t,s){},a800:function(e,t,s){},aa98:function(e,t,s){"use strict";var i=s("255b"),n=s.n(i);n.a},ac6a:function(e,t,s){for(var i=s("cadf"),n=s("0d58"),o=s("2aba"),a=s("7726"),r=s("32e9"),c=s("84f2"),u=s("2b4c"),l=u("iterator"),d=u("toStringTag"),v=c.Array,p={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},h=n(p),w=0;w<h.length;w++){var f,b=h[w],m=p[b],g=a[b],j=g&&g.prototype;if(j&&(j[l]||r(j,l,v),j[d]||r(j,d,b),c[b]=v,m))for(f in i)j[f]||o(j,f,i[f],!0)}},dee7:function(e,t,s){"use strict";s.r(t);var i=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"classroom"},[i("public-header",{attrs:{header:e.header}}),e.pageShow?i("scroll-content",{ref:"myscrollfull",attrs:{mescrollValue:e.mescrollValue}},[i("div",{staticClass:"time"},[e._v(e._s(e.hours)+":"+e._s(e.minutes))]),e.preview?i("preview-points",{attrs:{preview:e.preview}}):e._e(),e._l(e.showTopicList,function(t,s){return i("div",{key:s,staticClass:"class_topic_warp"},["objective"===t.quesetionType?i("div",{staticClass:"objective_warp"},[i("class-objective",{attrs:{objective:t},on:{selectAnswer:e.selectAnswer,Multipleanswers:e.Multipleanswers}}),"FINISH"!==t.questionStatus?i("div",{staticClass:"submit_warp"},[i("div",{staticClass:"objective_submit",on:{click:function(s){e.objective_submit(t.questionId)}}},[e._v("\n            提交\n          ")])]):e._e(),i("reply",{attrs:{reply:e.reply,type:t.type,id:t.questionId}}),"FINISH"===t.questionStatus?i("div",{staticClass:"closeReply"},[i("span",{staticClass:"text"},[e._v("老师已终止"+e._s(t.title)+"的作答")])]):e._e()],1):e._e(),"subjective"===t.quesetionType?i("div",{staticClass:"subjective_warp"},[i("subjective",{attrs:{subjectiveTopic:t}}),"FINISH"!==t.questionStatus?i("div",{staticClass:"button_warp"},[i("div",{directives:[{name:"show",rawName:"v-show",value:!e.objectiveAnswer[s].answer,expression:"!objectiveAnswer[index].answer"}],staticClass:"subjective_submit",on:{click:function(s){e.answerQuestions(t.questionId)}}},[e._v("开始答题\n          ")]),i("div",{directives:[{name:"show",rawName:"v-show",value:e.objectiveAnswer[s].answer,expression:"objectiveAnswer[index].answer"}],staticClass:"subjective_submit",on:{click:function(s){e.modifyAnswer(t.questionId)}}},[e._v("修改答案\n          ")])]):e._e(),i("board",{directives:[{name:"show",rawName:"v-show",value:e.isAnswer(e.objectiveAnswer[s].answer),expression:"isAnswer(objectiveAnswer[index].answer)"}],attrs:{subjectiveAnswer:e.objectiveAnswer,id:t.questionId}}),"FINISH"===t.questionStatus?i("div",{staticClass:"closeReply"},[i("span",{staticClass:"text"},[e._v("老师已终止"+e._s(t.title)+"的作答")])]):e._e()],1):e._e()])}),i("div",{class:{awbtn:e.btn===e.current},attrs:{id:"btn"},on:{click:e.Answerbtn}},[i("img",{attrs:{src:s("efde"),alt:""}})])],2):e._e(),i("div",{directives:[{name:"show",rawName:"v-show",value:e.AnswerShareshow,expression:"AnswerShareshow"}],staticClass:"AnswerShare"},[i("span",{staticClass:"btnout",on:{click:e.btnout}},[e._v("x")]),e._l(e.AnswerShareList,function(t,s){return i("div",{key:s,staticClass:"AnswerShareList"},[i("div",{staticClass:"question",attrs:{id:t.id},domProps:{innerHTML:e._s(t.title)}},[e._v(e._s(t.title))]),i("div",{staticClass:"answerimg"},[i("img",{attrs:{src:t.img,alt:""}})])])})],2),e.loading?i("loading"):e._e()],1)},n=[],o=(s("a481"),s("20d6"),s("96cf"),s("1da1")),a=(s("ceaa"),s("b2fb")),r=s.n(a),c=s("be94"),u=(s("5fc6"),s("5af2")),l=s.n(u),d=(s("ac6a"),s("5a5c")),v=s("d67f"),p=s("15d6"),h=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"topic_content"},[s("div",{staticClass:"title"},[e._v(e._s(e.title))]),s("div",{staticClass:"item"},[e._v("\n        "+e._s(e.preview)+"\n    ")])])},w=[],f=(s("3598"),{name:"previewPoints",props:{preview:{type:String,default:function(){return[]}}},data:function(){return{title:"预习要点"}}}),b=f,m=(s("17e2"),s("2877")),g=Object(m["a"])(b,h,w,!1,null,null,null);g.options.__file="previewPoints.vue";var j=g.exports,_=s("c2d9"),C=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"classroomOneReply"},e._l(e.select,function(t,i){return t?s("div",{key:i,staticClass:"reply_objective"},[s("div",{staticClass:"bubble"},[s("div",{staticClass:"answer"},[e._v(e._s(t))])]),s("public-avatar")],1):e._e()}))},S=[],y=(s("28a5"),s("c5f6"),function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"avatar_warp"},[s("img",{attrs:{src:e.userimg,alt:"头像"}})])}),I=[],A={name:"avatar",data:function(){return{userimg:""}},mounted:function(){this.getstudent()},methods:{getstudent:function(){var e=JSON.parse(localStorage.getItem("user"));"FEMALE"==e.userSex?this.userimg=s("3ff4"):this.userimg=s("38b5")}}},L=A,T=(s("f70f"),Object(m["a"])(L,y,I,!1,null,null,null));T.options.__file="avatar.vue";var x=T.exports,q={name:"Reply",props:{id:{type:[String,Number],default:""},type:{type:String,default:""},reply:{type:Array,default:function(){return[]}}},components:{PublicAvatar:x},data:function(){return{select:[],arr:[],show:!1}},watch:{reply:{handler:function(){for(var e="",t=0;t<this.reply.length;t++){for(var s=0;s<this.reply[t].answer.length;s++)e=this.reply[t].answer[s].split("|").join(","),this.reply[t].answer[s]=e;this.reply[t].id===this.id&&(this.select=this.reply[t].answer)}},immediate:!0,deep:!0}}},k=q,O=(s("aa98"),Object(m["a"])(k,C,S,!1,null,"5f02a760",null));O.options.__file="Reply.vue";var H=O.exports,P=s("b5a9"),F=s("8c36"),M=s("399a"),N=s("2f62"),B=s("4360"),E=s("cc7d"),R=s.n(E),$=s("74d1"),D=s.n($),V={components:{PublicHeader:v["a"],ScrollContent:p["a"],PreviewPoints:j,Subjective:_["a"],Reply:H,Board:P["a"],Loading:F["a"],ClassObjective:d["a"]},data:function(){return{AnswerShareList:[],AnswerShareshow:!1,btn:1,current:0,objectiveCount:0,subjectiveCount:0,course:"",progress:0,subjectiveId:"",topicList:[],topicListId:[],showTopicList:[],mescrollValue:{up:!1,down:!1},loading:!0,pageShow:!1,header:{title:"",url:"/studentIndex"},preview:"",objectiveAnswer:[],reply:[],hours:0,minutes:0,wsUrl:"http://school.jichuangsi.com:81",stompClient:null,subscription:null,token:localStorage.getItem("token")}},watch:{boardImg:function(e){var t=this,s=this;s.objectiveAnswer.forEach(function(i,n){i.id===s.subjectiveId&&(i.answer=e.data,t.$set(s.objectiveAnswer,n,i))}),Object(M["m"])(e.data).then(function(e){l()({message:"图片存储成功！",position:"middle",duration:1e3}),Object(M["n"])(t.course,t.subjectiveId,123,"test",e.data.data.stubForSubjective).then(function(e){console.log(e),l()({message:"答案提交成功！",position:"middle",duration:1e3})}).catch(function(e){l()({message:"答案提交失败！",position:"middle",duration:1e3}),console.log(e)})}).catch(function(e){l()({message:"图片存储失败！",position:"middle",duration:1e3}),console.log(e)})}},mounted:function(){this.getCourseId(),this.getClassrooms();var e=new Date;this.hours=e.getHours(),this.minutes=e.getMinutes(),this.minutes<10&&(this.minutes="0"+this.minutes),this.time(),this.connect()},computed:Object(c["a"])({},Object(N["b"])(["isBoard","isBlueTooth","boardImg"])),methods:{Answerbtn:function(){this.AnswerShareshow=!0},btnout:function(){this.btn=1,this.AnswerShareshow=!1},isAnswer:function(e){return!!e},answerQuestions:function(e){this.subjectiveId=e,window.HandwrittenBoard.isConnect(function(e){console.log(e)},function(e){switch(console.log(e),e.data.status){case 0:B["a"].commit("SET_BLUETOOTH",!0),window.HandwrittenBoard.exploration(),console.log("第一个");break;case 2:window.HandwrittenBoard.getBase64img(),console.log("第二个");break;default:break}})},addTopic:function(e){var t=this;t.topicList.forEach(function(s){if(s.questionId===e){var i=JSON.parse(JSON.stringify(s));switch(s.quesetionType){case"objective":t.objectiveCount++,i.title="客观题-"+t.objectiveCount;break;case"subjective":t.subjectiveCount++,i.title="主观题-"+t.subjectiveCount;break;default:return}t.showTopicList.push(i),t.objectiveAnswer.push({id:s.questionId,answer:""})}})},modifyAnswer:function(e){this.subjectiveId=e;for(var t="",s=0;s<this.objectiveAnswer.length;s++)e===this.objectiveAnswer[s].id&&(t=this.objectiveAnswer[s].answer);window.HandwrittenBoard.isConnect(function(e){console.log(e)},function(e){switch(console.log(e),e.data.status){case 0:B["a"].commit("SET_BLUETOOTH",!0),window.HandwrittenBoard.exploration(),console.log("第一个");break;case 2:window.HandwrittenBoard.getBase64img(t),console.log("第二个");break;default:break}})},selectAnswer:function(e,t){for(var s=0;s<this.objectiveAnswer.length;s++)this.objectiveAnswer[s].id===e&&(this.objectiveAnswer[s].answer=t)},Multipleanswers:function(e,t){for(var s=0;s<this.objectiveAnswer.length;s++)this.objectiveAnswer[s].id===e&&(this.objectiveAnswer[s].answer=t,console.log(this.objectiveAnswer[s].answer))},objective_submit:function(e){for(var t=0;t<this.objectiveAnswer.length;t++)if(this.objectiveAnswer[t].id===e){if(!this.objectiveAnswer[t].answer)return!1;if(0===this.reply.length)return this.reply.push({id:e,answer:[this.objectiveAnswer[t].answer]}),this.sendObjective(e,this.objectiveAnswer[t].answer),!1;for(var s=!1,i=0;i<this.reply.length;i++)if(this.reply[i].id===e)return this.reply[i].answer[this.reply[i].answer.length-1]!==this.objectiveAnswer[t].answer&&(this.reply[i].answer.push(this.objectiveAnswer[t].answer),this.sendObjective(e,this.objectiveAnswer[t].answer),s=!0,!1);if(!1===s)return console.log(this.objectiveAnswer[t].answer),this.reply.push({id:e,answer:[this.objectiveAnswer[t].answer]}),this.sendObjective(e,this.objectiveAnswer[t].answer),!1}},sendObjective:function(e,t){var s=this;Object(M["l"])(this.course,e,123,"test",t).then(function(e){l()({message:"答案提交成功！",position:"middle",duration:1e3}),console.log(s.reply)}).catch(function(e){l()({message:"答案提交失败！",position:"middle",duration:1e3}),console.log(e)})},questions:function(){if(this.isBoard){r.a.open({text:"正在获取手写板内容...",spinnerType:"fading-circle"});var e=this;setTimeout(function(){window.HandwrittenBoard.take(function(t){console.log(t),e.img=t.data.image,r.a.close(),l()("获取手写板内容成功!"),window.HandwrittenBoard.cleanup(function(){})})},300)}else window.HandwrittenBoard.exploration()},getClassrooms:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){var t,s,i,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=this,e.next=3,Object(M["c"])(t.course);case 3:s=e.sent,console.log(s),t.topicList=s.data.data.questions,t.preview=s.data.data.courseInfo,i=regeneratorRuntime.mark(function e(s){var i,n,o,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(i=t.topicList[s],"NOTSTART"!=i.questionStatus&&t.addTopic(i.questionId),!i.answerForStudent){e.next=13;break}if("objective"!==i.quesetionType){e.next=7;break}t.reply.push({id:i.questionId,answer:[i.answerForStudent.answerForObjective]}),e.next=13;break;case 7:if(!i.answerForStudent&&!i.answerForTeacher){e.next=13;break}return e.next=10,Object(M["g"])(i.answerForTeacher?i.answerForTeacher.stubForSubjective:i.answerForStudent.stubForSubjective);case 10:n=e.sent,o=t.objectiveAnswer.findIndex(function(e){return e.id===i.questionId}),-1!=o&&(a=t.objectiveAnswer[o],n.data.data&&(a.answer=n.data.data.content,t.$set(t.objectiveAnswer,o,a)));case 13:t.pageShow=!0,t.loading=!1;case 15:case"end":return e.stop()}},e,this)}),n=0;case 9:if(!(n<t.topicList.length)){e.next=14;break}return e.delegateYield(i(n),"t0",11);case 11:n++,e.next=9;break;case 14:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),time:function(){var e=this;setInterval(function(){var t=new Date;e.hours=t.getHours(),e.minutes=t.getMinutes(),e.minutes<10&&(e.minutes="0"+e.minutes)},1e3)},getCourseId:function(){this.course=this.$route.query.courseId,this.header.title=this.$route.query.courseName},connect:function(){var e=new R.a(this.wsUrl+"/websocket/course");this.stompClient=D.a.over(e),this.stompClient.heartbeat.outgoing=4e5,this.stompClient.heartbeat.incoming=0;var t={login:"mylogin",passcode:"mypasscode",userId:"curUserId",accessToken:this.token},s=this;this.stompClient.connect(t,function(e){console.log("Connected:"+e);var t={userId:"curUserId",accessToken:s.token};s.subscription=s.stompClient.subscribe("/topic/course/student/"+s.course,function(e){s.classData(e)},t)})},classData:function(e){var t=this,s=JSON.parse(e.body),i=this;s.data&&("QuestionForPublish"===s.data.wsType&&this.addTopic(s.data.questionId),"QuestionClose"===s.data.wsType&&i.showTopicList.forEach(function(e,t){e.questionId&&e.questionId===s.data.questionId&&(e.questionStatus="FINISH",i.$set(i.showTopicList,t,e))}),"AnswerShare"===s.data.wsType&&function(){var e=t;e.btn=0;for(var i=function(t){var i=e.topicList[t];i.questionId===s.data.questionId&&Object(M["g"])(s.data.picPath).then(function(t){if(t.data.data){var s="data:image/png;base64,"+t.data.data.content.replace(",","");e.AnswerShareList=[{id:i.questionId,title:i.questionContent,img:s}]}})},n=0;n<e.topicList.length;n++)i(n)}())}},beforeDestroy:function(){this.timer&&clearInterval(this.timer),this.stompClient.unsubscribe("/topic/course/student/"+this.course)}},G=V,J=(s("5e2c"),Object(m["a"])(G,i,n,!1,null,"49f22f83",null));J.options.__file="show.vue";t["default"]=J.exports},efde:function(e,t,s){e.exports=s.p+"img/答案.42fadfb2.png"},f70f:function(e,t,s){"use strict";var i=s("4726"),n=s.n(i);n.a},fba0:function(e,t,s){"use strict";var i=s("a800"),n=s.n(i);n.a}}]);